var t=function(){"use strict";function t(t,e){const n=e.replace(/[.*+^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*").replace(/\\\?/g,".");return new RegExp(`^${n}$`).test(t)}function e(){return window.location.href}let n=e();function o(t){const e={element:t,originalAttributes:{},originalClasses:Array.from(t.classList),originalStyles:{}};null!==t.textContent&&(e.originalText=t.textContent);for(let n=0;n<t.attributes.length;n++){const o=t.attributes[n];e.originalAttributes[o.name]=o.value}const n=window.getComputedStyle(t),o=["color","background-color","font-size","display","visibility","opacity"];for(const t of o)e.originalStyles[t]=n.getPropertyValue(t);return e}function r(t){const{element:e,originalText:n,originalAttributes:o,originalClasses:r,originalStyles:i}=t;void 0!==n&&(e.textContent=n),e.className=r.join(" ");for(const[t,n]of Object.entries(o))e.setAttribute(t,n);for(const[t,n]of Object.entries(i))e.style.setProperty(t,n)}const i=new Map;function s(t){const e=function(t,e){try{return Array.from(t.querySelectorAll(e))}catch(t){return[]}}(document,t.sel);if(0===e.length)return!1;let n=!0;for(const r of e)try{switch(i.has(r)||i.set(r,o(r)),t.type){case"text":c(r,t.value||"");break;case"attr.set":l(r,t.name||"",t.value||"");break;case"class.add":u(r,t.value||"");break;case"class.remove":f(r,t.value||"");break;case"style.set":y(r,t.value||"");break;case"image.set":d(r,t.value||"");break;case"remove":g(r);break;default:n=!1}}catch(t){n=!1}return n}function a(){for(const[t,e]of i)try{r(e)}catch(t){}i.clear()}function c(t,e){t.textContent=e}function l(t,e,n){""===n?t.removeAttribute(e):t.setAttribute(e,n)}function u(t,e){t.classList.add(e)}function f(t,e){t.classList.remove(e)}function y(t,e){const n=e.split(";").map(t=>t.trim()).filter(t=>t);for(const e of n){const[n,o]=e.split(":").map(t=>t.trim());n&&o&&t.style.setProperty(n,o)}}function d(t,e){t instanceof HTMLImageElement&&(t.src=e,t.removeAttribute("srcset"))}function g(t){t.style.display="none"}function p(t,e){return!(!t?.requireConsent||e.consent)||(!(!t?.dnt||!e.dnt)||!(!t?.gpc||!e.gpc))}function m(t,e,n,o){const r={dnt:"1"===navigator.doNotTrack||"yes"===navigator.doNotTrack,gpc:!0===navigator.globalPrivacyControl,consent:!localStorage.getItem("ld-sidecar-consent-denied")},i=e.find(t=>"pageview"===t.type);i&&function(t,e,n,o){if(!p({dnt:!0,gpc:!0},o))try{t.track(e,{flagKey:n,timestamp:Date.now()})}catch(t){}}(t,i.event,n,r),function(t,e,n,o){const r=e.filter(t=>"click"===t.type&&t.sel);0!==r.length&&document.addEventListener("click",e=>{if(p({dnt:!0,gpc:!0},o))return;const i=e.target;if(i)for(const e of r)if(e.sel&&i.matches(e.sel)){try{t.track(e.event,{flagKey:n,selector:e.sel,timestamp:Date.now()})}catch(t){}break}},!0)}(t,e,n,r)}let v=null,b=null,h=!1,k=null;function w(){const t="ld-sidecar-device-id";let e=localStorage.getItem(t);return e||(e="device_"+Math.random().toString(36).substr(2,9)+"_"+Date.now(),localStorage.setItem(t,e)),e}async function A(){if(v&&b)try{const n=v.variation(b.flagKey,null);if(!n||"object"!=typeof n)return void b.debug;if(!function(t){return t&&"object"==typeof t&&"number"==typeof t.v&&t.url&&Array.isArray(t.url.include)&&Array.isArray(t.url.exclude)&&Array.isArray(t.ops)}(n))return;if(!function(e,n){const o=e.toLowerCase();for(const e of n.exclude)if(t(o,e.toLowerCase()))return!1;if(0===n.include.length)return!0;for(const e of n.include)if(t(o,e.toLowerCase()))return!0;return!1}(e(),n.url))return void b.debug;n.antiFlicker&&function(t){if(!t.masks||0===t.masks.length)return;for(const e of t.masks){const t=document.querySelectorAll(e);for(const e of t)e.style.visibility="hidden"}k=window.setTimeout(()=>{S(t)},t.timeoutMs||600)}(n.antiFlicker),n.ops&&n.ops.length>0&&(!function(t){for(const e of t)s(e)}(n.ops),b.debug),n.goals&&n.goals.length>0&&m(v,n.goals,b.flagKey,b.privacy),n.antiFlicker&&S(n.antiFlicker)}catch(t){}}function S(t){if(k&&(clearTimeout(k),k=null),t.masks&&0!==t.masks.length)for(const e of t.masks){const t=document.querySelectorAll(e);for(const e of t)e.style.visibility=""}}const C={init:async function(t){if(!h){b=t;try{const{initialize:o}=await import("launchdarkly-js-client-sdk"),r={key:w(),anonymous:!0};v=o(t.clientSideID,r,{streaming:!1!==t.stream,bootstrap:"localStorage"}),await v.waitForInitialization(),await A(),!1!==t.spa&&function(){const t=history.pushState,o=history.replaceState,r=()=>{setTimeout(()=>{(function(){const t=e();return t!==n&&(n=t,!0)})()&&(a(),A())},100)};history.pushState=function(...e){t.apply(history,e),r()},history.replaceState=function(...t){o.apply(history,t),r()},window.addEventListener("popstate",r),window.addEventListener("hashchange",r)}(),h=!0,t.debug}catch(t){}}},getClient:()=>v,getConfig:()=>b,isInitialized:()=>h,reapply:A,restore:a};return window.LDSidecar=C,C}();
//# sourceMappingURL=ld-sidecar.min.js.map
